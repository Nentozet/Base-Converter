{% extends base_filename %}


{% block title %}{{ train_title }}{% endblock %}


{% block styles %}
    .operator-selector {
        min-width: 15em;
    }

    .operator-selector * {
        box-sizing: border-box;
    }

    .select {
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 40px;
        border-radius: .25rem;
        padding: 1em;
        transition: background 0.3s;
        cursor: point;
        font-weight: 500;
    }

    .select-clicked {
        border: 1px #28a645 solid;
        box-shadow: 0 0 3px 1px rgba(40, 166, 69, 0.5),
                    0 0 5px 2px rgba(116, 166, 128, 0.3);
    }

    .caret {
        width: 0;
        height: 0;
        transition: 0.3s;
    }

    .caret-rotate {
        transform: rotate(90deg);
    }

    .menu {
        list-style: none;
        padding: 0em 0.5em;
        box-shadow: 0 0.5em 1em rgba(0, 0, 0, 0.2);
        border-radius: 0.5em;
        position: relative;
        top: 0.4em;
        width: 100%;
        height: 0;
        transition: 200ms cubic-bezier(0.77, 0, 0.18, 1), background 0.3s;
        z-index: 1;
        overflow-y: scroll;
    }

    .menu::-webkit-scrollbar {
        width: 8px;
    }

    .menu li {
        align-items: center;
        height: 40px;
        padding: 0.5em;
        margin: 0.3em 0;
        border-radius: 0.5em;
        transition: background 0.3s, color 0.3s;
        cursor: pointer;
        font-weight: 500;
    }

    .text-fade-in {
        animation: textFade 300ms ease-out;
    }

    .menu-open {
        height: 10em;
    }

    @keyframes textFade {
        0% {
            transform: translate(-1em);
            opacity: 0;
        }
        100% {
            transform: translateX(0);
            opacity: 1;
        }
    }
{% endblock %}


{% block content %}
<div class="container">
    <h1 class="text-center mb-4">{{calculator_title}}</h1>
    <form method="post">
        <div class="form-group">
            <label for="number1">{{number_capitalized}} 1:</label>
            <input class="custom-input" id="number1" name="username" placeholder="{{ converter_placeholder_text_number }}" autocomplete="off" style="margin-bottom: 10px;" required>
            <input class="custom-input" id="base1" name="base1" placeholder="{{ converter_placeholder_text_base }}" autocomplete="off" required>
        </div>
        <div class="form-group">
            <label for="number2">{{number_capitalized}} 2:</label>
            <input class="custom-input" id="number2" name="username" placeholder="{{ converter_placeholder_text_number }}" autocomplete="off" style="margin-bottom: 10px;" required>
            <input class="custom-input" id="base2" name="base2" placeholder="{{ converter_placeholder_text_base }}" autocomplete="off" required>
        </div>
        <div class="operator-selector" style="user-select: none;">
            <div class="select">
                <span class="selected">+ {{addition}}</span>
                <div class="caret"></div>
            </div>
            <ul class="menu">
                <li class="operator-active">+ {{addition}}</li>
                <li>- {{subtraction}}</li>
                <li>* {{multiplication}}</li>
                <li>/ {{division}}</li>
            </ul>
        </div>
        <button type="submit" class="btn btn-success">{{calculate}}</button>
    </form>
</div>

<script>
    const dropdowns = document.querySelectorAll('.operator-selector');

    dropdowns.forEach(dropdown => {
            const select = dropdown.querySelector('.select');
            const caret = dropdown.querySelector('.caret');
            const menu = dropdown.querySelector('.menu');
            const options = dropdown.querySelectorAll('.menu li');
            const selected = dropdown.querySelector('.selected');

            select.addEventListener('click', () => {
                select.classList.toggle('select-clicked');
                caret.classList.toggle('caret-rotate');
                menu.classList.toggle('menu-open');
            });

            options.forEach(option => {
                option.addEventListener('click', () => {
                    selected.innerText = option.innerText;

                    selected.classList.add("text-fade-in");

                    setTimeout(() => {
                        selected.classList.remove("text-fade-in");
                    }, 300);

                    select.classList.remove('select-clicked');

                    caret.classList.remove('caret-rotate');

                    menu.classList.remove('menu-open');

                    options.forEach(option => {
                        option.classList.remove('operator-active');
                    });

                    option.classList.add('operator-active');
                });
            });

            window.addEventListener("click", e => {
                const size = dropdown.getBoundingClientRect();

                if(
                    e.clientX < size.left || e.clientX > size.right || e.clientY < size.top || e.clientY > size.bottom
                ) {
                    select.classList.remove('select-clicked');
                    caret.classList.remove('caret-rotate');

                    menu.classList.remove('menu-open');
                }
            });
        });
</script>
{% endblock %}
